KISA(한국인터넷진흥원)의 주요정보통신기반시설 기술적 취약점 분석·평가 가이드에 있는 **W-18 (W18CheckIISDatabaseConnectionVulnerabilities)** 항목은 **"IIS DB 연결 취약점 점검"**을 의미합니다.

한마디로 요약하면 **"웹 사이트 설정 파일 속에 데이터베이스(DB) 접속용 아이디와 비밀번호가 암호화되지 않은 채 '평문(있는 그대로)'으로 적혀 있는지 확인하라"**는 뜻입니다.

상세한 의미와 보안 위험성, 그리고 안전하게 관리하는 방법은 다음과 같습니다.

---

### 1. 핵심 의미: "비밀번호가 적힌 쪽지"

웹 사이트가 작동하려면 데이터베이스(DB)와 연결해야 합니다. 이때 **"어떤 DB에, 어떤 아이디와 비밀번호로 접속할지"**를 적어두는 문장을 **DB 연결 문자열(Connection String)**이라고 합니다.

* **취약한 상태 (평문 저장):**
* `web.config`나 `global.asax`, `.asp` 소스 코드 파일 안에 다음과 같이 적혀 있는 경우입니다.
* `Server=DB_Server; User ID=admin; Password=1234;`
* 누군가 이 파일을 열어보면 DB 비밀번호를 바로 알 수 있습니다.


* **안전한 상태 (암호화 또는 윈도우 인증):**
* 비밀번호가 아예 없거나(윈도우 통합 인증 사용),
* `0x1A2B3C...` 처럼 사람이 읽을 수 없게 **암호화**되어 저장된 경우입니다.



### 2. 점검 목적 (Why?)

"서버 안에 있는 파일인데 누가 본다고 그러나요?"

해커가 웹 서버를 공격할 때 가장 먼저 노리는 것이 바로 이 **설정 파일(`web.config` 등)**입니다.

1. **정보 유출의 연쇄 작용:**
* 해커가 웹 서버의 단순한 취약점(파일 다운로드, 디렉터리 리스팅 등)을 통해 설정 파일을 훔쳐봅니다.
* 파일 안에 적힌 **DB 최고 관리자(sa) 비밀번호**를 획득합니다.
* 이제 해커는 웹 사이트를 거치지 않고 **DB에 직접 접속하여 고객의 개인정보를 몽땅 털어갑니다.**


2. **내부자 위협:**
* 웹 소스 코드를 유지보수하는 개발자나, 서버에 접근 가능한 내부 직원이 DB 비밀번호를 쉽게 알 수 있게 되어 보안 사고의 위험이 커집니다.



### 3. 점검 기준 (Pass/Fail)

KISA 가이드라인에 따른 판단 기준은 다음과 같습니다.

* **양호 (Safe):**
* DB 연결 정보가 소스 코드나 설정 파일에 **평문으로 저장되어 있지 않은 경우**
* 부득이하게 저장해야 한다면, **암호화** 처리가 되어 있거나 파일 접근 권한이 엄격하게 제한된 경우


* **취약 (Vulnerable):**
* `web.config`, `global.asax`, `.udl`, `.dsn` 파일 등에 DB 접속 아이디와 패스워드가 **평문(Clear Text)**으로 노출된 경우



### 4. 조치 방법 (어떻게 숨겨야 하나요?)

가장 안전한 순서대로 조치 방법은 다음과 같습니다.

#### 방법 A. 윈도우 통합 인증 사용 (가장 권장)

DB 연결 문자열에 아이디/비밀번호를 아예 적지 않는 방법입니다.

* **설정 예:** `Integrated Security=SSPI;` 또는 `Trusted_Connection=True;`
* **원리:** 웹 서버(IIS)가 실행되는 계정의 권한을 그대로 사용하여 DB에 접속합니다. (W-82 항목과 연결됨)

#### 방법 B. 설정 파일 섹션 암호화 (ASP.NET 권장)

`web.config` 파일에 비밀번호를 적되, 마이크로소프트가 제공하는 도구로 해당 부분만 암호화해버리는 것입니다.

1. **명령어 실행:** 윈도우 터미널(관리자)에서 `aspnet_regiis` 도구 사용
2. **명령 예시:** `aspnet_regiis -pe "connectionStrings" -app "/MyApp"`
3. **결과:** 사람이 파일을 열어봐도 외계어 같은 난수만 보이지만, IIS는 이를 자동으로 해석해서 정상 작동합니다.

#### 방법 C. 파일 접근 권한 제한 (최소한의 조치)

암호화가 불가능한 레거시 시스템(Classic ASP 등)이라면, 해당 파일을 **아무나 열어볼 수 없게** 윈도우 파일 권한(ACL)을 수정해야 합니다.

* `Everyone`, `Users` 그룹의 권한을 제거하고, **Administrators**와 **SYSTEM** 계정만 읽을 수 있게 설정합니다.

### 요약

> **W-18 항목은 "DB 접속 비밀번호를 '포스트잇'처럼 아무 데나 붙여놓지 말고, 금고(암호화)에 넣어두라"는 뜻입니다.**

웹 서버가 털리는 것은 '문'이 뚫린 것이지만, DB 비밀번호가 털리는 것은 '집문서'가 넘어가는 것과 같으므로 매우 중요한 항목입니다.