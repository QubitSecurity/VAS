KISA(한국인터넷진흥원)의 주요정보통신기반시설 기술적 취약점 분석·평가 가이드에 있는 **W-22 (W22CheckIISExecShellInvocation)** 항목은 **"IIS 웹 서버에서 SSI(Server Side Includes)의 실행(Exec) 명령어 사용 금지"**를 의미합니다.

한마디로 요약하면 **"웹 페이지 소스 코드 안에 `` 같은 명령어를 숨겨서, 서버의 운영체제 명령어(CMD)를 몰래 실행하는 것을 막아라"**는 뜻입니다.

상세한 의미와 보안 위험성, 조치 방법은 다음과 같습니다.

---

### 1. 핵심 의미: "웹 페이지가 곧 명령 프롬프트?"

**SSI (Server Side Includes)**는 HTML 문서 안에 서버의 동적인 정보(날짜, 파일 크기 등)를 쉽게 표시하기 위해 만들어진 오래된 기술입니다. 주로 `.shtml`, `.stm`, `.shtm` 확장자를 사용합니다.

문제는 SSI의 기능 중에 **`#exec`**라는 무시무시한 명령어가 있다는 점입니다.

* **취약한 상태 (Exec 허용):**
* 웹 페이지 파일 안에 ``라고 적으면, 사용자가 이 페이지를 열람하는 순간 서버는 **`del *.*` (파일 삭제)** 명령어를 실행해 버립니다.


* **안전한 상태 (Exec 금지):**
* SSI 기능을 아예 쓰지 않거나, 쓰더라도 **`#exec` 명령어만 콕 집어서 금지(`SSIExecDisable`)**시킨 상태입니다.



### 2. 점검 목적 (Why?)

"요즘 누가 SSI를 쓰나요?"

맞습니다. 최신 웹 환경에서는 거의 쓰이지 않지만, **레거시 시스템(오래된 서버)**이나 **실수로 켜져 있는 경우**가 문제입니다.

1. **원격 명령 실행 (RCE):** 해커가 게시판에 `#exec` 태그가 포함된 파일을 업로드하고 실행시키면, 서버의 모든 권한을 탈취할 수 있습니다.
2. **서버 정보 유출:** `` 같은 명령어로 서버의 파일 목록을 훔쳐볼 수 있습니다.

### 3. 점검 기준 (Pass/Fail)

KISA 가이드라인에 따른 판단 기준은 다음과 같습니다.

* **양호 (Safe):**
* SSI 기능을 아예 사용하지 않거나(삭제),
* 사용하더라도 레지스트리 설정에서 **`SSIExecDisable` 값이 1 (사용 안 함)**로 설정된 경우


* **취약 (Vulnerable):**
* SSI 기능을 사용 중인데 `SSIExecDisable` 값이 0 (사용함)으로 되어 있거나, 설정이 없는 경우



### 4. 설정 확인 및 조치 방법 (레지스트리 편집)

이 설정은 IIS 관리 콘솔보다는 **윈도우 레지스트리(Registry)**를 수정해야 확실합니다.

1. **레지스트리 편집기 실행:** `Win + R` > `regedit` 입력
2. **경로 이동:**
* `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters`


3. **값 확인:**
* **`SSIExecDisable`**이라는 이름의 DWORD 값이 있는지 확인합니다.


4. **조치:**
* **값이 없으면:** 새로 만들기(DWORD 32비트) > 이름: `SSIExecDisable`
* **값 데이터:** **`1`**로 설정합니다. (1 = Exec 기능 끄기, 0 = Exec 기능 켜기)



### 💡 더 근본적인 해결책: 역할 제거

만약 회사에서 `.shtml`이나 `.stm` 같은 확장자를 쓰는 웹 페이지가 없다면, 굳이 위험한 기능을 남겨둘 필요가 없습니다.

* **서버 관리자 > 역할 및 기능 제거**에서 **[웹 서버(IIS)] > [응용 프로그램 개발] > [서버 측 포함(Server Side Includes)]** 체크를 해제하여 **삭제**하는 것이 가장 안전합니다.

### 요약

> **W-22 항목은 "웹 페이지가 서버 명령창(CMD)을 마음대로 부르지 못하게 입을 막아라"는 뜻입니다.**

이 기능(`SSI #exec`)은 보안상 이점은 없고 위험만 크기 때문에, 특수한 경우가 아니라면 무조건 **비활성화(Disable)**하는 것이 원칙입니다.

이로써 KISA 가이드의 윈도우(IIS) 주요 점검 항목들을 거의 다 훑어보았습니다. 긴 시간 동안 고생 많으셨습니다! 혹시 다른 OS(리눅스/유닉스)나 DB, 네트워크 장비 등 추가로 궁금한 점검 항목이 있으신가요?