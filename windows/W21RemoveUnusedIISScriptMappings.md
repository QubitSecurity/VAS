KISA(한국인터넷진흥원)의 주요정보통신기반시설 기술적 취약점 분석·평가 가이드에 있는 **W-21 (W21RemoveUnusedIISScriptMappings)** 항목은 **"IIS 미사용 스크립트 매핑 제거"**를 의미합니다.

한마디로 요약하면 **"우리 웹 사이트에서 쓰지도 않는 파일 확장자(.htr, .idc, .stm 등)를 서버가 해석하려고 들지 않게, 연결 고리(매핑)를 끊어버려라"**는 뜻입니다.

상세한 의미와 왜 이것이 위험한지, 어떻게 제거하는지 설명해 드리겠습니다.

---

### 1. 핵심 의미: "불필요한 통역사 해고하기"

웹 서버(IIS)는 특정 확장자를 가진 파일 요청이 들어오면, 이를 처리할 프로그램(DLL 파일)을 연결해 줍니다. 이것을 **스크립트 매핑(Script Mapping)** 또는 **처리기 매핑(Handler Mapping)**이라고 합니다.

* **.asp 요청:**  `asp.dll`이 처리 (필요함)
* **.aspx 요청:**  `aspnet_isapi.dll`이 처리 (필요함)
* **.htr 요청:**  `ism.dll`이 처리 (**불필요 - 취약점 원인**)
* **.idc 요청:**  `httpodbc.dll`이 처리 (**불필요**)

**W-21**은 이 중에서 **실제 서비스에 사용하지 않는 확장자들**이 여전히 연결되어 있는지 확인하고, 불필요한 연결은 끊으라는 것입니다.

### 2. 점검 목적 (Why?)

"안 쓰는 기능이 연결되어 있으면 왜 위험한가요?"

**해커는 파일이 없어도, 그 파일을 처리하는 프로그램(DLL)을 공격할 수 있기 때문입니다.**

1. **버퍼 오버플로우 공격:** 과거에 `.htr`, `.ida`, `.idq`, `.printer` 등의 확장자를 처리하는 DLL 파일들에서 치명적인 **버퍼 오버플로우(Buffer Overflow)** 취약점이 발견되었습니다.
2. **공격 표면 감소:** 서버에 해당 파일(예: `test.htr`)이 존재하지 않더라도, 해커가 주소창에 `http://사이트/nonexist.htr`을 입력하면 IIS는 `ism.dll`을 호출합니다. 이때 DLL 자체의 취약점을 이용해 서버 권한을 탈취할 수 있습니다.

### 3. 점검 기준 (Pass/Fail)

KISA 가이드라인에 따른 판단 기준은 다음과 같습니다.

* **양호 (Safe):**
* `.htr`, `.idc`, `.stm`, `.shtm`, `.printer`, `.htw`, `.ida`, `.idq` 등 사용하지 않는 확장자 매핑이 **제거된 경우**


* **취약 (Vulnerable):**
* 위와 같은 불필요한 확장자 매핑이 여전히 존재하는 경우



### 4. 삭제 대상 (주요 블랙리스트)

다음 확장자들은 아주 오래된 기술이거나 보안상 문제가 많아, 특별한 사유가 없다면 **무조건 제거**해야 합니다.

* **.htr:** 비밀번호 변경 기능 (매우 취약)
* **.idc:** 데이터베이스 커넥터
* **.stm, .shtm, .shtml:** 서버 측 포함 파일 (SSI)
* **.printer:** 인터넷 인쇄 프로토콜
* **.htw, .ida, .idq:** 인덱싱 서비스 관련

### 5. 설정 확인 및 조치 방법 (IIS 관리자)

IIS 7.0 이상 버전에서는 **"처리기 매핑(Handler Mappings)"** 메뉴에서 관리합니다.

1. **IIS 관리자 실행:** `Win + R` > `inetmgr` 입력
2. **서버 또는 사이트 선택:** 전체 서버 설정이나 특정 사이트를 선택합니다.
3. **처리기 매핑(Handler Mappings) 더블 클릭:** 중앙 기능 보기 화면에 있습니다.
4. **목록 확인:**
* 우측의 목록에서 위에서 언급한 확장자(`.htr`, `.idc` 등)가 있는지 찾습니다.
* *(참고: 최신 IIS에서는 기본적으로 많이 제거되어 있습니다.)*


5. **조치 (제거):**
* 해당 매핑을 선택하고 우측 작업 패널에서 **[제거(Remove)]**를 클릭합니다.
* 또는 **[기능 사용 권한 편집]**에서 '실행' 권한을 끄는 방법도 있습니다.



### 💡 주의사항: 무조건 다 지우면 안 됨!

* **.asp, .aspx, .svc** 등 현재 운영 중인 웹 사이트가 사용하는 확장자를 지우면 **웹 사이트가 작동하지 않습니다.** (404 에러 또는 다운로드 창이 뜹니다.)
* 반드시 **"사용하지 않는"** 확장자만 골라서 지워야 합니다.

### 요약

> **W-21 항목은 "쓰지도 않는 확장자(.htr, .idc)는 해커의 놀이터가 되니, 아예 인식하지 못하게 연결을 끊어라"는 뜻입니다.**

이것으로 IIS(웹 서버) 관련 주요 보안 설정은 대부분 마무리되었습니다. 혹시 **W-22 (서버 정보 노출 방지)** 등 남은 항목이나, 점검하시면서 헷갈렸던 다른 부분이 있으신가요?