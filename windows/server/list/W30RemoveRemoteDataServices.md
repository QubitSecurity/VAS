KISA(한국인터넷진흥원)의 주요정보통신기반시설 기술적 취약점 분석·평가 가이드에 있는 **W-30 (W30RemoveRemoteDataServices)** 항목은 **"RDS(Remote Data Services) 제거"**를 의미합니다.

한마디로 요약하면 **"해커가 웹 브라우저를 통해 서버의 데이터베이스를 마음대로 조작하거나, 심지어 서버의 관리자 권한을 탈취할 수 있는 '매우 위험한 구형 기능'을 삭제하라"**는 뜻입니다.

상세한 의미와 왜 이 기능이 위험한지, 어떻게 제거해야 하는지 설명해 드리겠습니다.

---

### 1. 핵심 의미: "원격 조종 리모컨"

**RDS (Remote Data Services)**는 과거 마이크로소프트가 웹 페이지에서 데이터베이스(DB)와 쉽게 통신하기 위해 만든 기술입니다. (MDAC 구성 요소 중 하나)

이 기능이 켜져 있으면, IIS 웹 서버에는 **`/MSADC`**라는 가상 디렉터리가 생성됩니다.

* **취약한 상태 (RDS 존재):**
* 해커가 `/MSADC` 경로를 통해 특정한 명령(`msadcs.dll` 호출)을 보내면, 인증 절차를 우회하여 DB 쿼리를 날릴 수 있습니다.
* 더 무서운 것은, 이를 이용해 **`cmd.exe` (명령 프롬프트)**를 실행하여 서버를 장악할 수 있다는 점입니다.


* **안전한 상태 (RDS 제거):**
* 불필요한 `/MSADC` 가상 디렉터리가 삭제되어 있어, 외부에서 해당 DLL에 접근할 수 없습니다.



### 2. 점검 목적 (Why?)

"옛날 기능인데 아직도 위험한가요?"

네, 이 취약점은 **역사상 가장 유명하고 위험했던 IIS 취약점** 중 하나입니다.

1. **관리자 권한 탈취 (Remote Command Execution):**
* RDS 취약점을 이용하면 해커는 웹 서버의 **SYSTEM 권한(최고 관리자)**으로 임의의 명령어를 실행할 수 있습니다.
* 즉, 방화벽이 있어도 웹 포트(80)만 열려 있다면 서버를 통째로 해커에게 넘겨주는 꼴이 됩니다.


2. **데이터베이스 유출 및 파괴:**
* ODBC 연결을 통해 내부 데이터베이스에 접속하여 데이터를 훔치거나 삭제할 수 있습니다.



### 3. 점검 기준 (Pass/Fail)

KISA 가이드라인에 따른 판단 기준은 다음과 같습니다.

* **양호 (Safe):**
* IIS에 **`/MSADC`** 가상 디렉터리가 존재하지 않는 경우 (삭제됨)
* 또는 레지스트리에서 RDS 기능 사용을 제한한 경우


* **취약 (Vulnerable):**
* **`/MSADC`** 가상 디렉터리가 존재하며, 실제로 접근 가능한 경우



### 4. 설정 확인 및 조치 방법 (IIS 관리자)

이 항목은 **IIS 관리자**에서 눈으로 확인하고 지우면 됩니다. (W-19 가상 디렉터리 삭제 항목과 유사합니다.)

1. **IIS 관리자 실행:** `Win + R` > `inetmgr` 입력
2. **사이트 트리 확장:** '기본 웹 사이트(Default Web Site)' 하위 목록을 펼칩니다.
3. **MSADC 찾기:**
* 목록 중에 **`MSADC`**라는 이름의 가상 디렉터리(지구본 아이콘 등)가 있는지 확인합니다.


4. **조치 (삭제):**
* 해당 디렉터리를 우클릭하고 **[제거(Remove)]**를 선택합니다.
* *(참고: 이 폴더는 RDS 전용이므로, 일반적인 웹 사이트 운영에는 전혀 필요가 없습니다. 과감히 지우셔도 됩니다.)*



### 💡 참고: 최신 서버 환경

Windows Server 2003 이후 버전부터는 보안이 강화되어, 기본적으로 RDS가 설치되지 않거나 비활성화되어 있는 경우가 많습니다.

하지만 **오래된 서버에서 설정을 그대로 마이그레이션(복사)**해 왔거나, 특정 레거시 프로그램을 위해 억지로 켜둔 경우에는 여전히 이 취약점이 살아있을 수 있으므로 반드시 확인해야 합니다.

### 요약

> **W-30 항목은 "해킹 프리패스권이나 다름없는 'MSADC' 폴더를 무조건 지워라"는 뜻입니다.**

이 기능은 보안상 이점은 없고 위험도만 최상(High)이므로, 발견 즉시 삭제하는 것이 원칙입니다.

---

이로써 **W-01부터 W-30까지**, KISA 주요정보통신기반시설(Windows Server) 취약점 가이드의 핵심 항목들을 대부분 살펴보셨습니다.

긴 과정 동안 하나하나 확인하시느라 정말 고생 많으셨습니다! 이 내용들을 바탕으로 서버를 점검하신다면 보안 수준이 획기적으로 높아질 것입니다.

혹시 **점검 보고서 작성 팁**이 필요하시거나, **리눅스/유닉스/DB/장비** 등 다른 분야의 취약점 항목도 궁금하신 게 있다면 언제든 다시 물어봐 주세요.