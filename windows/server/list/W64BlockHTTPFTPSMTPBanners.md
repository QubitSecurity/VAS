KISA(한국인터넷진흥원)의 주요정보통신기반시설 기술적 취약점 분석·평가 가이드에 있는 **W-64 (W64BlockHTTPFTPSMTPBanners)** 항목은 **"HTTP, FTP, SMTP 서비스의 배너(Banner) 정보 차단"**을 의미합니다.

한마디로 요약하면 **"서버에 접속하는 사람에게 '나는 윈도우 2016 서버이고, FTP 프로그램 버전은 10.0이야'라고 친절하게 자기소개를 하지 마라"**는 뜻입니다.

상세한 의미와 왜 이것이 위험한지, 어떻게 숨겨야 하는지 설명해 드리겠습니다.

---

### 1. 핵심 의미: "명찰 떼기 (버전 숨김)"

서버는 클라이언트(사용자)가 접속하면, 연결이 성공했다는 신호로 환영 메시지(Welcome Message)를 보냅니다. 이것을 **"배너(Banner)"**라고 합니다.

* **취약한 상태 (정보 노출):**
* **FTP:** `220 Microsoft FTP Service 10.0`
* **SMTP:** `220 mail.company.com Microsoft ESMTP MAIL Service, Version: 10.0.17763.1`
* **HTTP:** `Server: Microsoft-IIS/10.0`
* 이렇게 구체적인 **소프트웨어 이름과 버전**을 그대로 보여줍니다.


* **안전한 상태 (정보 변경):**
* **FTP:** `220 Authorized users only` (경고문으로 대체)
* **SMTP:** `220 mail.company.com ESMTP` (버전 삭제)
* **HTTP:** 헤더 정보 삭제 (W-59 참조)



### 2. 점검 목적 (Why?)

"버전 좀 알려주는 게 왜 위험한가요?"

해커들의 첫 번째 공격 단계인 **"정보 수집(Banner Grabbing)"**을 방해하기 위해서입니다.

1. **맞춤형 공격(Exploit) 예방:**
* 해커가 `IIS 6.0`이라는 정보를 얻으면, 즉시 인터넷에서 "IIS 6.0 취약점"을 검색합니다.
* 만약 버전을 모르면, 해커는 어떤 공격 코드를 써야 할지 몰라 이것저것 찔러봐야 하므로 공격 난이도가 올라갑니다.


2. **자동화 스캔 회피:**
* 해커들은 자동화 봇(Bot)을 돌려 "특정 취약한 버전"의 서버만 찾아다닙니다. 배너를 숨기면 이런 무차별 스캔 대상에서 제외될 확률이 높습니다.



### 3. 점검 기준 (Pass/Fail)

KISA 가이드라인에 따른 판단 기준은 다음과 같습니다.

* **양호 (Safe):**
* FTP, SMTP, HTTP 서비스 접속 시, **버전 정보(Version)와 OS 종류**가 노출되지 않도록 배너를 변경하거나 삭제한 경우


* **취약 (Vulnerable):**
* 서비스 접속 시 기본(Default) 배너가 출력되어, 서버의 버전 및 종류를 쉽게 파악할 수 있는 경우



### 4. 설정 확인 및 조치 방법

각 서비스별로 설정하는 곳이 다릅니다. (주로 Windows Server 기준)

#### A. FTP 서비스 (IIS 관리자)

1. **IIS 관리자 실행:** `inetmgr`
2. **FTP 사이트 선택:** 설정할 FTP 사이트 클릭
3. **FTP 메시지(FTP Messages) 더블 클릭:**
4. **배너 입력:**
* **배너(Banner):** 항목에 `Microsoft FTP Service` 같은 기본 문구 대신, **"Warning: Authorized users only"** 같은 경고 문구나 법적 고지 내용을 입력합니다.
* *(이렇게 하면 접속 시 버전 정보 대신 입력한 문구가 뜹니다.)*



#### B. SMTP 서비스 (IIS 6.0 관리자 또는 Exchange)

윈도우 서버의 기본 SMTP는 보통 **IIS 6.0 관리자**에서 설정합니다.

1. **IIS 6.0 관리자 실행:** `inetmgr6` (또는 서버 관리자 도구에서 실행)
2. **SMTP Virtual Server 우클릭 > 속성(Properties)**
3. **일반(General) 탭:** 연결 설정 등의 메뉴가 있지만, 배너 변경 UI가 없는 경우가 많습니다.
4. **메타베이스 수정 (고급):**
* 보통 `Adsutil.vbs` 스크립트를 사용하거나 메타베이스를 직접 수정하여 `ConnectResponse` 값을 변경해야 합니다.
* *(최신 Exchange Server라면 수신 커넥터(Receive Connector) 설정에서 배너를 변경합니다.)*



#### C. HTTP 서비스 (웹 서버)

* 이 부분은 앞서 설명드린 **W-59 (IIS 웹 서비스 정보 숨김)** 항목과 동일합니다.
* `web.config` 설정이나 URL Rewrite 모듈을 이용해 `Server` 헤더를 삭제하거나 변경합니다.

### 요약

> **W-64 항목은 "해커에게 '나는 OOO 버전이니까 여기를 때리면 돼'라고 약점을 알려주지 마라"는 뜻입니다.**

기본 환영 메시지를 **"관계자 외 접속 금지"** 같은 일반적인 경고 문구로 바꾸는 것이 가장 안전합니다.

---

이로써 **KISA 윈도우(IIS) 취약점 점검 가이드의 주요 항목들(W-01 ~ W-64)**을 전체적으로 훑어보셨습니다!

계정 관리부터 서비스, IIS 설정, 로그, 네트워크 보안까지 긴 여정이었습니다. 이 내용들을 바탕으로 서버를 점검하신다면, 기본적인 보안 구멍은 대부분 막았다고 보셔도 됩니다.

혹시 **리눅스(Unix)** 서버나 **데이터베이스(DB)**, **네트워크 장비** 등 다른 영역의 점검 항목도 궁금하신가요? 아니면 지금까지의 내용 중 더 깊이 알고 싶은 부분이 있으신가요?