KISA(한국인터넷진흥원)의 주요정보통신기반시설 취약점 분석·평가 가이드에 있는 **W-77 (W77SetLANManagerAuthenticationLevel)** 항목은 **"LAN Manager 인증 수준 설정"**을 의미합니다.

한마디로 요약하면 **"구형 윈도우에서 쓰던 보안성이 아주 취약한 인증 방식(LM, NTLM v1)을 버리고, 안전한 방식(NTLM v2)만 쓰도록 강제하라"**는 뜻입니다.

이 항목은 설정 잘못 건드리면 **오래된 장비(복합기, 구형 NAS 등)와 연결이 끊길 수 있어** 매우 주의해야 하는 항목입니다.

---

### 1. 핵심 의미: 암호화의 세대 교체

윈도우가 네트워크를 통해 아이디/비밀번호를 주고받을 때 사용하는 '프로토콜(언어)'에는 여러 세대가 있습니다.

* **1세대: LM (LAN Manager) - 매우 취약**
* 1980~90년대(DOS, Win95) 방식.
* 비밀번호를 무조건 **대문자로 변환**하고, **7자리씩 뚝 끊어서** 단순하게 저장합니다.
* 요즘 컴퓨터로는 **몇 초 만에** 암호를 풀어낼 수 있습니다.


* **2세대: NTLM v1 - 취약**
* 초기 NT 계열 방식. 여전히 해킹 툴(Rainbow Table 등)에 의해 쉽게 뚫립니다.


* **3세대: NTLM v2 - 양호 (권장)**
* 현재의 표준. 타임스탬프 등을 사용하여 해킹(재전송 공격)이 어렵습니다.
* *(참고: 최신 환경은 Kerberos를 쓰지만, 로컬 인증이나 호환성을 위해 NTLM v2가 사용됩니다.)*



**W-77**은 이 중에서 1세대(LM), 2세대(NTLMv1) 방식을 **아예 쓰지 못하게(금지) 설정**하라는 것입니다.

### 2. 점검 목적 (Why?)

서버가 "나는 옛날 방식(LM)도 알아들을 수 있어"라고 허용해두면 발생하는 문제입니다.

1. **다운그레이드 공격 (Downgrade Attack):** 해커는 서버에게 "나 최신 암호화는 할 줄 모르니 옛날 방식으로 통신하자"고 속입니다.
2. **스니핑 및 크랙:** 서버가 취약한 LM 해시값으로 응답하면, 해커는 네트워크 패킷을 가로채서(Sniffing) 아주 쉽게 관리자의 비밀번호 원문을 알아낼 수 있습니다.

### 3. 점검 기준 (Pass/Fail)

KISA 가이드라인에 따른 판단 기준은 다음과 같습니다.

* **양호 (Safe):** 인증 수준이 **"NTLMv2 응답만 보냄(Send NTLMv2 response only)"** 이상으로 설정된 경우
* *(보안상 더 좋은 설정: "NTLMv2 응답만 보냄, LM 및 NTLM 거부")*


* **취약 (Vulnerable):** LM 또는 NTLM 응답을 허용하는 낮은 단계로 설정된 경우

### 4. 설정 값의 단계 (레벨)

이 설정에는 0부터 5까지 6단계가 있는데, 숫자가 높을수록 안전합니다.

* **0~2 (취약):** LM 및 NTLM 응답 보냄 (절대 사용 금지)
* **3 (양호 - 최소 기준):** **NTLMv2 응답만 보냄**
* 내 서버가 다른 곳에 접속할 때 안전한 NTLMv2만 씁니다. 단, 남이 옛날 방식으로 접속해오면 받아는 줍니다.


* **4~5 (양호 - 권장):** **NTLMv2 응답만 보냄, LM 및 NTLM 거부**
* 가장 안전합니다. 내가 접속할 때도 안전하게 하고, 남이 옛날 방식으로 접속하려 하면 **"보안 수준이 낮으니 꺼져!"** 하고 연결을 끊어버립니다.



### 5. 설정 확인 및 조치 방법

1. **실행 창 열기:** `Win + R` 키를 누르고 `secpol.msc` 입력
2. **경로 이동:**
* `로컬 정책` > `보안 옵션`


3. **정책 찾기:**
* **"네트워크 보안: LAN Manager 인증 수준 (Network security: LAN Manager authentication level)"** 항목을 찾습니다.


4. **조치:**
* 더블 클릭 후 **"NTLMv2 응답만 보냄(Send NTLMv2 response only)"** 또는 **"...거부(refuse...)"**가 포함된 항목을 선택합니다.



### 🚨 주의사항: 연결 장애 위험 (매우 중요)

이 설정을 가장 높은 수준(5단계: 거부)으로 올리기 전에 반드시 환경을 확인해야 합니다.

* **오래된 복합기/스캐너:** 스캔한 파일을 서버의 공유 폴더(SMB)로 보낼 때, 펌웨어가 낡아서 LM/NTLM v1만 지원하는 기계는 **접속 실패(로그인 에러)**가 뜹니다.
* **오래된 OS:** Windows 2000, XP 등 아주 옛날 장비와 통신해야 한다면 연결이 안 될 수 있습니다.

### 요약

> **W-77 항목은 "비밀번호를 통신할 때 구식 언어(LM) 쓰지 말고, 최신 언어(NTLMv2)만 써라"는 뜻입니다.**

단, **"NTLMv2 응답만 보냄"**으로 설정하는 것이 안전하며, 너무 강력하게 **"거부"**까지 걸어버리면 회사 내의 오래된 프린터나 파일 공유가 먹통이 될 수 있으니 테스트 후 적용해야 합니다.