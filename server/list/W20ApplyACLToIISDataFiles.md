KISA(한국인터넷진흥원)의 주요정보통신기반시설 기술적 취약점 분석·평가 가이드에 있는 **W-20 (W20ApplyACLToIISDataFiles)** 항목은 **"IIS 데이터 파일에 대한 접근 권한(ACL) 설정"**을 의미합니다.

한마디로 요약하면 **"웹 사이트의 파일들(HTML, 이미지, 소스코드 등)을 아무나 지우거나 수정하지 못하도록, 윈도우의 파일 권한 설정을 꽉 잠가라"**는 뜻입니다.

상세한 의미와 왜 이 설정이 중요한지, 어떻게 설정해야 하는지 설명해 드리겠습니다.

---

### 1. 핵심 의미: "파일의 주인만 수정 가능하게"

**ACL (Access Control List, 접근 제어 목록)**은 윈도우에서 "누가 이 파일을 읽고, 쓰고, 지울 수 있는지"를 적어놓은 명단입니다.

* **취약한 상태 (Everyone Full Control):**
* 웹 루트 폴더(`C:\Inetpub\wwwroot`)에 **`Everyone` (모든 사람)** 그룹이 **'모든 권한(Full Control)'**이나 **'쓰기(Write)'** 권한을 가지고 있는 경우입니다.
* 누구나 파일을 지우거나, 해커가 악성 스크립트(Web Shell)를 만들어 넣을 수 있습니다.


* **안전한 상태 (Restricted):**
* **관리자(Administrator)**와 **시스템(SYSTEM)** 계정만 모든 권한을 가집니다.
* 일반 사용자나 웹 접속 계정(`IUSR`)은 오직 **'읽기(Read)'** 권한만 가집니다.



### 2. 점검 목적 (Why?)

"웹 사이트는 누구나 들어와서 보는 건데, 권한을 막으면 안 보이지 않나요?"

**'보는 것(Read)'과 '수정하는 것(Write)'은 엄격히 구분해야 합니다.**

1. **웹 변조 방지 (Defacement):** 쓰기 권한이 열려 있으면, 해커가 메인 페이지(`index.html`)를 "Hacked by..."라는 문구로 바꿔치기할 수 있습니다.
2. **악성코드 유포 방지:** 해커가 정상적인 파일 사이에 악성 스크립트를 몰래 끼워 넣어, 방문자들의 PC를 감염시키는 경유지로 악용할 수 있습니다.
3. **랜섬웨어/삭제 방지:** 중요 데이터를 암호화하거나 삭제해버리는 공격을 막습니다.

### 3. 점검 기준 (Pass/Fail)

KISA 가이드라인에 따른 판단 기준은 다음과 같습니다.

* **양호 (Safe):**
* 웹 루트 디렉터리(`C:\Inetpub\wwwroot`) 및 하위 폴더에 **`Everyone`** 그룹의 권한이 없거나, 있더라도 **'쓰기'** 권한이 제거된 경우
* 불필요한 사용자 그룹(Users, Guests 등)의 권한이 최소화된 경우


* **취약 (Vulnerable):**
* **`Everyone`** 그룹에 **'모든 권한'** 또는 **'쓰기'** 권한이 부여된 경우



### 4. 설정 확인 및 조치 방법 (윈도우 탐색기)

이 설정은 IIS 관리자가 아닌 **파일 탐색기**에서 폴더 속성을 변경해야 합니다.

1. **폴더 이동:** 웹 사이트의 홈 디렉터리(보통 `C:\Inetpub\wwwroot`)로 이동합니다.
2. **속성 열기:** 폴더 위에서 마우스 우클릭 > **[속성(Properties)]** 선택
3. **보안 탭 이동:** 상단의 **[보안(Security)]** 탭 클릭
4. **권한 확인:**
* **그룹 또는 사용자 이름** 목록에 `Everyone`이 있는지 확인합니다.
* 있다면, 아래쪽 **사용 권한**에서 '쓰기(Write)'나 '모든 권한'에 체크가 되어 있는지 확인합니다.


5. **조치 (권한 제거):**
* **[편집(Edit)]** 버튼을 누릅니다.
* `Everyone` 그룹을 선택하고 **[제거(Remove)]**하거나, '쓰기' 체크를 해제합니다.
* *(웹 서비스를 위해 `IUSR` 또는 `IIS_IUSRS` 그룹에게는 '읽기 및 실행' 권한만 줍니다.)*



### 💡 주의사항: 업로드 폴더는 예외?

게시판의 **파일 업로드 폴더**(`Upload`, `Data` 등)는 사용자가 파일을 저장해야 하므로 **'쓰기'** 권한이 필요합니다.

* **딜레마:** 쓰기 권한을 주면 해커도 파일을 올릴 수 있습니다.
* **해결책:** 업로드 폴더에는 **'쓰기'** 권한을 주되, **W-12 (실행 권한 제거)** 설정을 통해 해당 폴더에서 파일이 **'실행(Execute)'**되는 것은 반드시 막아야 합니다.
* 즉, **쓰기(O) + 실행(X)** 조합으로 설정해야 안전합니다.



### 요약

> **W-20 항목은 "웹 사이트 폴더의 문단속을 철저히 하라"는 뜻입니다.**
> 관리자 외에는 아무도 파일을 고치거나 지울 수 없게 '쓰기' 권한을 뺏어야 안전합니다.

이로써 IIS 관련 주요 취약점 항목들을 대부분 살펴보았습니다. 혹시 **로그 설정(W-01)**이나 **IIS 오류 페이지 설정** 등 다른 부분도 점검이 필요하신가요?