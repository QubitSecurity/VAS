KISA(한국인터넷진흥원)의 주요정보통신기반시설 기술적 취약점 분석·평가 가이드에 있는 **W-12 (W12RestrictIISCGIExecution)** 항목은 **"IIS CGI 실행 권한 제한"**을 의미합니다.

한마디로 요약하면 **"웹 서버의 폴더 안에서 실행 파일(.exe, .bat, .cmd 등)이 제멋대로 작동하지 못하도록, '실행 권한'을 뺏어라"**는 뜻입니다.

상세한 의미와 보안 위험성, 조치 방법은 다음과 같습니다.

---

### 1. 핵심 의미: "스크립트" vs "실행 파일"

웹 서버가 파일을 처리하는 권한은 크게 3단계로 나뉩니다.

1. **없음 (None):** 아무것도 실행 안 됨. (이미지, HTML 등 정적 파일만 가능)
2. **스크립트 (Scripts Only):** 약속된 웹 언어(.asp, .aspx, .php)만 해석해서 실행. **(일반적인 웹 사이트 설정)**
3. **스크립트 및 실행 파일 (Scripts and Executables):** 웹 언어뿐만 아니라 서버 내의 **프로그램(.exe, .dll, .cmd)**까지 직접 실행 가능. **(CGI 방식 - 취약, 점검 대상)**

**W-12**는 3번 설정, 즉 **"스크립트 및 실행 파일" 권한이 불필요하게 부여된 것을 막으라는 것**입니다.

### 2. 점검 목적 (Why?)

"실행 파일 좀 돌리면 안 되나요?"  **해커에게 무기를 쥐어주는 꼴이 됩니다.**

* **위험 시나리오:**
1. 해커가 게시판의 파일 업로드 기능을 이용해 악성 프로그램(`hack.exe` 또는 `webshell.dll`)을 업로드합니다.
2. 해당 폴더에 **"실행(Executables)"** 권한이 켜져 있습니다.
3. 해커가 웹 브라우저로 `http://사이트/upload/hack.exe`를 호출합니다.
4. 서버는 이 파일을 다운로드시키는 게 아니라, **서버 내부에서 실행**시켜버립니다.
5. 서버가 해커의 손에 넘어갑니다.



따라서 꼭 필요한 경우(아주 오래된 CGI 기반 게시판 등)가 아니라면, **"실행(Executable)" 권한은 반드시 꺼야 합니다.**

### 3. 점검 기준 (Pass/Fail)

KISA 가이드라인에 따른 판단 기준은 다음과 같습니다.

* **양호 (Safe):**
* 웹 사이트의 홈 디렉터리 및 하위 폴더의 실행 권한이 **"스크립트 전용(Scripts only)"** 또는 **"없음(None)"**으로 설정된 경우


* **취약 (Vulnerable):**
* 실행 권한이 **"스크립트 및 실행 파일(Scripts and Executables)"**로 설정된 디렉터리가 존재하는 경우



### 4. 설정 확인 및 조치 방법 (IIS 관리자)

1. **IIS 관리자 실행:** `Win + R` > `inetmgr` 입력
2. **사이트 선택:** 점검할 웹 사이트 혹은 폴더를 클릭합니다.
3. **처리기 매핑(Handler Mappings) 더블 클릭:**
* 중앙 화면의 IIS 섹션에 있습니다.


4. **기능 사용 권한 편집(Edit Feature Permissions) 클릭:**
* 우측 작업(Actions) 패널에 있습니다.


5. **조치:**
* **"실행(Execute)"** 체크 박스를 **해제**합니다.
* 보통 **"스크립트(Script)"**만 체크되어 있으면 웹 사이트는 정상 작동합니다. (단, 이미지 업로드 폴더 같은 곳은 '스크립트'조차 체크 해제하여 '없음'으로 만드는 것이 가장 안전합니다.)



### 요약

> **W-12 항목은 "웹 서버에서 .exe 같은 프로그램이 실행되는 '위험한 스위치'를 꺼라"는 뜻입니다.**

요즘 웹 환경(.NET, Java, PHP)에서는 CGI(실행 파일 방식)를 거의 쓰지 않으므로, 이 권한이 켜져 있다면 백해무익한 보안 구멍일 확률이 높습니다.

혹시 **W-13 (CGI 디렉터리 접근 제한)**이나 **W-14 (상위 디렉터리 접근 금지)** 같은 다른 IIS 관련 보안 설정도 설명해 드릴까요?